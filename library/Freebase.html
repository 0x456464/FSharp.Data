<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>F# Data: Freebase Provider
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The F# Data library implements type providers for working with structured file formats (CSV, JSON and XML) and for accessing the WorldBank and Freebase data. It also includes helpers for other data-related tasks.">
    <meta name="author" content="Tomas Petricek">

    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="http://fsharp.github.com/FSharp.Data/content/style.css" />
    <script src="http://fsharp.github.com/FSharp.Data/content/tips.js" type="text/javascript"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/fsharp/FSharp.Data">github page</a></li>
          <li><a href="http://fsharp.github.com/fsharpx/">fsharpx library</a></li>
        </ul>
        <h3 class="muted">F# Data Library</h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          <h1>F# Data: Freebase Provider</h1>

<p>The <a href="http://www.freebase.com">Freebase graph database</a> contains information on over 
23 million entities, with information on a wide variety of subjects ranging from books 
and movies to historical figures and events to chemical elements, as well as rich 
interconnections between the entities.</p>

<p>The Freebase type provider puts this information at your fingertips, giving you strongly-typed
access to a treasure trove of data. This article provides a brief introduction showing
some of the features.</p>

<p>The type provide is also used on the <a href="http://www.tryfsharp.org">Try F#</a> web site in the 
"Data Science" tutorial, so you can find more examples there. The Visual Studio F# Team 
Blog also has a series of 4 blog posts about it <a href="http://blogs.msdn.com/b/fsharpteam/archive/2012/09/21/the-f-3-0-freebase-type-provider-sample-integrating-internet-scale-data-sources-into-a-strongly-typed-language.aspx">here</a>
and you can watch a recorded demo by Don Syme <a href="http://skillsmatter.com/podcast/scala/an-informal-deep-dive-with-don-syme-the-freebase-type-provider">here</a>.</p>

<h2>Introducing the provider</h2>

<p>The following example loads the <code>FSharp.Data.dll</code> library (in F# Interactive), 
initializes a connection to Freebase using the <code>GetDataContext</code> method:</p>
<pre class="fssnip">
<span class="l">1: </span><span class="prep">#r</span> <span class="s">&quot;</span><span class="s">.</span><span class="s">.</span><span class="s">/</span><span class="s">.</span><span class="s">.</span><span class="s">/</span><span class="s">bin</span><span class="s">/</span><span class="s">FSharp</span><span class="s">.</span><span class="s">Data</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>
<span class="l">2: </span><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Data</span>
<span class="l">3: </span>
<span class="l">4: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">data</span> <span class="o">=</span> <span class="i">FreebaseData</span><span class="o">.</span><span class="i">GetDataContext</span>()</pre>
<h3>Exploring Freebase data</h3>

<p>Now you can explore the Freebase data schema by typing <code>data.</code> and exploring the
available data sources in the autocomplete. For example, the following snippet
retrieves the Chemical Elements and then looks at the details of Hydrogen:</p>
<pre class="fssnip">
<span class="l">1: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">elements</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="i">data</span><span class="o">.</span><span class="i">``Science and Technology``</span><span class="o">.</span><span class="i">Chemistry</span><span class="o">.</span><span class="i">``Chemical Elements``</span>
<span class="l">2: </span>
<span class="l">3: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="i">all</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 7)" onmouseover="showTip(event, 'fs4', 7)" class="i">elements</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="i">toList</span>
<span class="l">4: </span><span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Elements</span><span class="s"> </span><span class="s">found</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">d</span><span class="s">&quot;</span> (<span onmouseout="hideTip(event, 'fs6', 11)" onmouseover="showTip(event, 'fs6', 11)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="i">length</span> <span onmouseout="hideTip(event, 'fs5', 13)" onmouseover="showTip(event, 'fs5', 13)" class="i">all</span>)
<span class="l">5: </span>
<span class="l">6: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="i">hydrogen</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 15)" onmouseover="showTip(event, 'fs4', 15)" class="i">elements</span><span class="o">.</span><span class="i">Individuals</span><span class="o">.</span><span class="i">Hydrogen</span>
<span class="l">7: </span><span onmouseout="hideTip(event, 'fs8', 16)" onmouseover="showTip(event, 'fs8', 16)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Atominc</span><span class="s"> </span><span class="s">number</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs10', 17)" onmouseover="showTip(event, 'fs10', 17)" class="i">hydrogen</span><span class="o">.</span><span class="i">``Atomic number``</span></pre>
<h3>Generating test cases</h3>

<p>There is a lot of different data available on Freebase, and you can use it for all 
kinds of purposes. The following snippet uses the database of celebrities to generate
realistic names for testing purposes. First, we obtain two arrays - one containing
100 first names (based on names of celebrities) and another obtaining 100 surnames
(from an Freebase list of last names):</p>
<pre class="fssnip">
<span class="l"> 1: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 18)" onmouseover="showTip(event, 'fs11', 18)" class="i">firstnames</span> <span class="o">=</span> 
<span class="l"> 2: </span>    <span onmouseout="hideTip(event, 'fs3', 19)" onmouseover="showTip(event, 'fs3', 19)" class="i">data</span><span class="o">.</span><span class="i">Society</span><span class="o">.</span><span class="i">Celebrities</span><span class="o">.</span><span class="i">Celebrities</span>
<span class="l"> 3: </span>    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 20)" onmouseover="showTip(event, 'fs6', 20)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 21)" onmouseover="showTip(event, 'fs12', 21)" class="i">truncate</span> <span class="n">100</span>
<span class="l"> 4: </span>    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 22)" onmouseover="showTip(event, 'fs6', 22)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 23)" onmouseover="showTip(event, 'fs13', 23)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs14', 24)" onmouseover="showTip(event, 'fs14', 24)" class="i">celeb</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs14', 25)" onmouseover="showTip(event, 'fs14', 25)" class="i">celeb</span><span class="o">.</span><span class="i">Name</span><span class="o">.</span><span class="i">Split</span>([|<span class="s">&#39; &#39;</span>|])<span class="o">.</span>[<span class="n">0</span>])
<span class="l"> 5: </span>    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 26)" onmouseover="showTip(event, 'fs15', 26)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 27)" onmouseover="showTip(event, 'fs16', 27)" class="i">ofSeq</span>
<span class="l"> 6: </span>
<span class="l"> 7: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 28)" onmouseover="showTip(event, 'fs17', 28)" class="i">surnames</span> <span class="o">=</span> 
<span class="l"> 8: </span>    <span onmouseout="hideTip(event, 'fs3', 29)" onmouseover="showTip(event, 'fs3', 29)" class="i">data</span><span class="o">.</span><span class="i">Society</span><span class="o">.</span><span class="i">People</span><span class="o">.</span><span class="i">``Family names``</span>
<span class="l"> 9: </span>    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 30)" onmouseover="showTip(event, 'fs6', 30)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 31)" onmouseover="showTip(event, 'fs12', 31)" class="i">truncate</span> <span class="n">100</span>
<span class="l">10: </span>    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 32)" onmouseover="showTip(event, 'fs6', 32)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 33)" onmouseover="showTip(event, 'fs13', 33)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs18', 34)" onmouseover="showTip(event, 'fs18', 34)" class="i">name</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs18', 35)" onmouseover="showTip(event, 'fs18', 35)" class="i">name</span><span class="o">.</span><span class="i">Name</span>)
<span class="l">11: </span>    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 36)" onmouseover="showTip(event, 'fs15', 36)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 37)" onmouseover="showTip(event, 'fs16', 37)" class="i">ofSeq</span></pre>
<p>To generate realistic test case data, we now write a helper function that picks a 
random element from the array and then concatenate a random first name with a 
random surname:</p>
<pre class="fssnip">
<span class="l">1: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 38)" onmouseover="showTip(event, 'fs19', 38)" class="i">randomElement</span> <span class="o">=</span> 
<span class="l">2: </span>    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 39)" onmouseover="showTip(event, 'fs20', 39)" class="i">random</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs21', 40)" onmouseover="showTip(event, 'fs21', 40)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 41)" onmouseover="showTip(event, 'fs22', 41)" class="i">Random</span>()
<span class="l">3: </span>    <span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs23', 42)" onmouseover="showTip(event, 'fs23', 42)" class="i">arr</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs24', 43)" onmouseover="showTip(event, 'fs24', 43)" class="i">string</span>[]) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs23', 44)" onmouseover="showTip(event, 'fs23', 44)" class="i">arr</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs20', 45)" onmouseover="showTip(event, 'fs20', 45)" class="i">random</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 46)" onmouseover="showTip(event, 'fs25', 46)" class="i">Next</span>(<span onmouseout="hideTip(event, 'fs23', 47)" onmouseover="showTip(event, 'fs23', 47)" class="i">arr</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 48)" onmouseover="showTip(event, 'fs26', 48)" class="i">Length</span>)]
<span class="l">4: </span>
<span class="l">5: </span><span class="k">for</span> <span onmouseout="hideTip(event, 'fs27', 49)" onmouseover="showTip(event, 'fs27', 49)" class="i">i</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span class="n">10</span> <span class="k">do</span>
<span class="l">6: </span>  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 50)" onmouseover="showTip(event, 'fs28', 50)" class="i">name</span> <span class="o">=</span> 
<span class="l">7: </span>    (<span onmouseout="hideTip(event, 'fs19', 51)" onmouseover="showTip(event, 'fs19', 51)" class="i">randomElement</span> <span onmouseout="hideTip(event, 'fs11', 52)" onmouseover="showTip(event, 'fs11', 52)" class="i">firstnames</span>) <span class="o">+</span> <span class="s">&quot;</span><span class="s"> </span><span class="s">&quot;</span> <span class="o">+</span>
<span class="l">8: </span>    (<span onmouseout="hideTip(event, 'fs19', 53)" onmouseover="showTip(event, 'fs19', 53)" class="i">randomElement</span> <span onmouseout="hideTip(event, 'fs17', 54)" onmouseover="showTip(event, 'fs17', 54)" class="i">surnames</span>)
<span class="l">9: </span>  <span onmouseout="hideTip(event, 'fs8', 55)" onmouseover="showTip(event, 'fs8', 55)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">%</span><span class="s">s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs28', 56)" onmouseover="showTip(event, 'fs28', 56)" class="i">name</span></pre>
<h2>Querying Freebase data</h2>

<p>In the previous examples, we used <code>Seq</code> functions to work with the collections returned by 
Freebase type provider. This works in simple cases, but it is inefficient if we need to 
filter the data or perform other querying.</p>

<p>However, the Freebase provider includes support for querying. Queries written using the
F# 3.0 LINQ syntax are translated to MQL (a querying language used by Freebase). This means 
you can write queries in F# 3.0 with auto-completion and strong typing, and still execute 
efficiently on the server, at least for the queries translated to MQL.</p>

<p>The following example returns starts, together with their distance from Earth (stars
without known distance are skipped):</p>
<pre class="fssnip">
<span class="l">1: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 57)" onmouseover="showTip(event, 'fs29', 57)" class="i">astronomy</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 58)" onmouseover="showTip(event, 'fs3', 58)" class="i">data</span><span class="o">.</span><span class="i">``Science and Technology``</span><span class="o">.</span><span class="i">Astronomy</span>
<span class="l">2: </span>
<span class="l">3: </span><span onmouseout="hideTip(event, 'fs30', 59)" onmouseover="showTip(event, 'fs30', 59)" class="i">query</span> { <span class="k">for</span> <span onmouseout="hideTip(event, 'fs31', 60)" onmouseover="showTip(event, 'fs31', 60)" class="i">e</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs29', 61)" onmouseover="showTip(event, 'fs29', 61)" class="i">astronomy</span><span class="o">.</span><span class="i">Stars</span> <span class="k">do</span> 
<span class="l">4: </span>        <span onmouseout="hideTip(event, 'fs32', 62)" onmouseover="showTip(event, 'fs32', 62)" class="k">where</span> <span onmouseout="hideTip(event, 'fs31', 63)" onmouseover="showTip(event, 'fs31', 63)" class="i">e</span><span class="o">.</span><span class="i">Distance</span><span class="o">.</span><span class="i">HasValue</span>
<span class="l">5: </span>        <span onmouseout="hideTip(event, 'fs33', 64)" onmouseover="showTip(event, 'fs33', 64)" class="k">select</span> (<span onmouseout="hideTip(event, 'fs31', 65)" onmouseover="showTip(event, 'fs31', 65)" class="i">e</span><span class="o">.</span><span class="i">Name</span>, <span onmouseout="hideTip(event, 'fs31', 66)" onmouseover="showTip(event, 'fs31', 66)" class="i">e</span><span class="o">.</span><span class="i">Distance</span>) } 
<span class="l">6: </span>      <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 67)" onmouseover="showTip(event, 'fs6', 67)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 68)" onmouseover="showTip(event, 'fs7', 68)" class="i">toList</span></pre>
<p>To make the example shorter, we first defined a variable <code>astronomy</code> that represents the
domain of astronomical data. We also need to add <code>Seq.toList</code> to the end to actually 
execute the query and get results back in a list.</p>

<p>The following query returns stars that have a known distance and are close to Earth:</p>
<pre class="fssnip">
<span class="l">1: </span><span onmouseout="hideTip(event, 'fs30', 69)" onmouseover="showTip(event, 'fs30', 69)" class="i">query</span> { <span class="k">for</span> <span onmouseout="hideTip(event, 'fs31', 70)" onmouseover="showTip(event, 'fs31', 70)" class="i">e</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs29', 71)" onmouseover="showTip(event, 'fs29', 71)" class="i">astronomy</span><span class="o">.</span><span class="i">Stars</span> <span class="k">do</span> 
<span class="l">2: </span>        <span onmouseout="hideTip(event, 'fs32', 72)" onmouseover="showTip(event, 'fs32', 72)" class="k">where</span> (<span onmouseout="hideTip(event, 'fs31', 73)" onmouseover="showTip(event, 'fs31', 73)" class="i">e</span><span class="o">.</span><span class="i">Distance</span><span class="o">.</span><span class="i">Value</span> <span class="o">&lt;</span> <span class="n">4.011384e+18</span><span class="o">&lt;</span>_<span class="o">&gt;</span>)
<span class="l">3: </span>        <span onmouseout="hideTip(event, 'fs33', 74)" onmouseover="showTip(event, 'fs33', 74)" class="k">select</span> <span onmouseout="hideTip(event, 'fs31', 75)" onmouseover="showTip(event, 'fs31', 75)" class="i">e</span> } 
<span class="l">4: </span>      <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 76)" onmouseover="showTip(event, 'fs6', 76)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 77)" onmouseover="showTip(event, 'fs7', 77)" class="i">toList</span></pre>
<p>The query language supports a number of advanced operators in addition to simple 
<code>where</code> and <code>select</code>. For example, we can sort the stars by distance from Earth and
then select 10 closest stars:</p>
<pre class="fssnip">
<span class="l">1: </span><span onmouseout="hideTip(event, 'fs30', 78)" onmouseover="showTip(event, 'fs30', 78)" class="i">query</span> { <span class="k">for</span> <span onmouseout="hideTip(event, 'fs31', 79)" onmouseover="showTip(event, 'fs31', 79)" class="i">e</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs29', 80)" onmouseover="showTip(event, 'fs29', 80)" class="i">astronomy</span><span class="o">.</span><span class="i">Stars</span> <span class="k">do</span> 
<span class="l">2: </span>        <span onmouseout="hideTip(event, 'fs34', 81)" onmouseover="showTip(event, 'fs34', 81)" class="k">sortBy</span> <span onmouseout="hideTip(event, 'fs31', 82)" onmouseover="showTip(event, 'fs31', 82)" class="i">e</span><span class="o">.</span><span class="i">Distance</span><span class="o">.</span><span class="i">Value</span>
<span class="l">3: </span>        <span onmouseout="hideTip(event, 'fs35', 83)" onmouseover="showTip(event, 'fs35', 83)" class="k">take</span> <span class="n">10</span>
<span class="l">4: </span>        <span onmouseout="hideTip(event, 'fs33', 84)" onmouseover="showTip(event, 'fs33', 84)" class="k">select</span> <span onmouseout="hideTip(event, 'fs31', 85)" onmouseover="showTip(event, 'fs31', 85)" class="i">e</span> } 
<span class="l">5: </span>      <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 86)" onmouseover="showTip(event, 'fs6', 86)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 87)" onmouseover="showTip(event, 'fs7', 87)" class="i">toList</span> </pre>
<h3>Freebase query operators</h3>

<p>In addition to the standard F# 3.0 query operators, the namespace <code>FSharp.Data.FreebaseOperators</code> 
defines a couple more Freebase specific operators such as <code>ApproximatelyMatches</code>, <code>ApproximatelyOneOf</code>,
<code>ApproximateCount</code> and <code>Count</code>. These are translated to specific MQL operations.</p>

<p>For example, the following snippet uses <code>Count</code> and <code>ApproximateCount</code> to count the number
of US presidents (in this case, <code>ApproximateCount</code> is not very useful, because counting the
exact number is efficient enough):</p>
<pre class="fssnip">
<span class="l">1: </span><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 88)" onmouseover="showTip(event, 'fs1', 88)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 89)" onmouseover="showTip(event, 'fs2', 89)" class="i">Data</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 90)" onmouseover="showTip(event, 'fs36', 90)" class="i">FreebaseOperators</span>
<span class="l">2: </span>
<span class="l">3: </span><span onmouseout="hideTip(event, 'fs3', 91)" onmouseover="showTip(event, 'fs3', 91)" class="i">data</span><span class="o">.</span><span class="i">Society</span><span class="o">.</span><span class="i">Government</span><span class="o">.</span><span class="i">``US Presidents``</span><span class="o">.</span><span class="i">Count</span>()
<span class="l">4: </span><span onmouseout="hideTip(event, 'fs3', 92)" onmouseover="showTip(event, 'fs3', 92)" class="i">data</span><span class="o">.</span><span class="i">Society</span><span class="o">.</span><span class="i">Government</span><span class="o">.</span><span class="i">``US Presidents``</span><span class="o">.</span><span class="i">ApproximateCount</span>()</pre>
<p>The <code>ApproximatelyMatches</code> operator can be used, for example, when working with strings.
The following snippet searches for books that have a name <em>approximately matching</em> the 
specified string:</p>
<pre class="fssnip">
<span class="l">1: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs37', 93)" onmouseover="showTip(event, 'fs37', 93)" class="i">topBooksWithNameContaining</span> (<span onmouseout="hideTip(event, 'fs38', 94)" onmouseover="showTip(event, 'fs38', 94)" class="i">s</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs24', 95)" onmouseover="showTip(event, 'fs24', 95)" class="i">string</span>) <span class="o">=</span> 
<span class="l">2: </span>    <span onmouseout="hideTip(event, 'fs30', 96)" onmouseover="showTip(event, 'fs30', 96)" class="i">query</span> { <span class="k">for</span> <span onmouseout="hideTip(event, 'fs39', 97)" onmouseover="showTip(event, 'fs39', 97)" class="i">book</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs3', 98)" onmouseover="showTip(event, 'fs3', 98)" class="i">data</span><span class="o">.</span><span class="i">``Arts and Entertainment``</span><span class="o">.</span><span class="i">Books</span><span class="o">.</span><span class="i">Books</span> <span class="k">do</span>
<span class="l">3: </span>            <span onmouseout="hideTip(event, 'fs32', 99)" onmouseover="showTip(event, 'fs32', 99)" class="k">where</span> (<span onmouseout="hideTip(event, 'fs39', 100)" onmouseover="showTip(event, 'fs39', 100)" class="i">book</span><span class="o">.</span><span class="i">Name</span><span class="o">.</span><span class="i">ApproximatelyMatches</span> <span onmouseout="hideTip(event, 'fs38', 101)" onmouseover="showTip(event, 'fs38', 101)" class="i">s</span>)
<span class="l">4: </span>            <span onmouseout="hideTip(event, 'fs35', 102)" onmouseover="showTip(event, 'fs35', 102)" class="k">take</span> <span class="n">10</span> 
<span class="l">5: </span>            <span onmouseout="hideTip(event, 'fs33', 103)" onmouseover="showTip(event, 'fs33', 103)" class="k">select</span> <span onmouseout="hideTip(event, 'fs39', 104)" onmouseover="showTip(event, 'fs39', 104)" class="i">book</span><span class="o">.</span><span class="i">Name</span> }
<span class="l">6: </span> 
<span class="l">7: </span><span onmouseout="hideTip(event, 'fs37', 105)" onmouseover="showTip(event, 'fs37', 105)" class="i">topBooksWithNameContaining</span> <span class="s">&quot;</span><span class="s">1984</span><span class="s">&quot;</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 106)" onmouseover="showTip(event, 'fs6', 106)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 107)" onmouseover="showTip(event, 'fs7', 107)" class="i">toList</span></pre>
<h2>Advanced provider fatures</h2>

<p>The Freebase type provider has a number of features and it is beyond the scope of this 
introduction to discuss all of them. Some of the aspects were already demonstrated and more
documentation can be found in the articles linked in the introduction. To give a brief 
summary, here is a list of features:</p>

<ul>
<li>Many queries are translated efficiently into the MQL language. Those that can't 
execute on the client side by default.</li>
<li>A selection of sample individuals is given under the <code>Individuals</code> entry for each collection 
of objects. This allows you to program against strongly named individual such as
<code>Hydrogen</code> or <code>Bob Dylan</code>.</li>
<li>Custom Freebase operators such as approximate counts and approximate string matching are supported</li>
<li>Image URLs are provided via the <code>GetImages()</code> method, and the first image is provided using the 
<code>MainImage</code> property</li>
<li>Snapshot dates for Freebase are supported. This means that you can view the state of the
Freebase database on a specific date (also meaning that your application will not break
when the schema changes).</li>
<li>Optional client-side caching of schema information makes type checking quick and efficient</li>
<li>Units of measure are supported. For example, the <code>Atomic mass</code> property of chemical elements
is automatically converted to SI units and it is exposed in Kilograms. This is statically
tracked in the F# type system using units of measure.</li>
<li>If you want to query larger amount of Freebase data, you can register at Google and
obtain a custom API key. The key can be passed as a static parameter to the type provider.</li>
</ul>

<h3>Providing an API key</h3>

<p>The Freebase API is rate limited, and initially you are using some quota available for debugging purposes.
If you get the (403) Forbidden error, then this shows you are hitting rate limitations. 
You will need an API key with the Freebase service enabled. This gives you 100,000 requests/day. 
The F# Data Library also provides the <code>FreebaseDataProvider</code> type which allows you to specify several 
static parameters, including the API key:</p>
<pre class="fssnip">
<span class="l">1: </span>[&lt;<span onmouseout="hideTip(event, 'fs40', 108)" onmouseover="showTip(event, 'fs40', 108)" class="i">Literal</span>&gt;]
<span class="l">2: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs41', 109)" onmouseover="showTip(event, 'fs41', 109)" class="i">FreebaseApiKey</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">&lt;</span><span class="s">enter</span><span class="s"> </span><span class="s">your</span><span class="s"> </span><span class="s">freebase</span><span class="s">-</span><span class="s">enabled</span><span class="s"> </span><span class="s">google</span><span class="s"> </span><span class="s">API</span><span class="s"> </span><span class="s">key</span><span class="s"> </span><span class="s">here</span><span class="s">&gt;</span><span class="s">&quot;</span>
<span class="l">3: </span>
<span class="l">4: </span><span class="k">type</span> <span onmouseout="hideTip(event, 'fs42', 110)" onmouseover="showTip(event, 'fs42', 110)" class="i">FreebaseDataWithKey</span> <span class="o">=</span> <span class="i">FreebaseDataProvider</span><span class="o">&lt;</span><span class="i">Key</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs41', 111)" onmouseover="showTip(event, 'fs41', 111)" class="i">FreebaseApiKey</span><span class="o">&gt;</span>
<span class="l">5: </span><span class="k">let</span> <span onmouseout="hideTip(event, 'fs43', 112)" onmouseover="showTip(event, 'fs43', 112)" class="i">dataWithKey</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 113)" onmouseover="showTip(event, 'fs42', 113)" class="i">FreebaseDataWithKey</span><span class="o">.</span><span class="i">GetDataContext</span>()</pre>
<h3>Debugging MQL queries</h3>

<p>If you want to understand how Freebase type provider work, or if you want to debug a 
performance issue, it might be useful to see the requests that the provider sends to 
Freebase. This can be done by subscribing to the <code>SendingRequest</code> event:</p>
<pre class="fssnip">
<span class="l">1: </span><span onmouseout="hideTip(event, 'fs3', 114)" onmouseover="showTip(event, 'fs3', 114)" class="i">data</span><span class="o">.</span><span class="i">DataContext</span><span class="o">.</span><span class="i">SendingRequest</span><span class="o">.</span><span class="i">Add</span> (<span class="k">fun</span> <span class="i">e</span> <span class="k">-&gt;</span> 
<span class="l">2: </span>  <span onmouseout="hideTip(event, 'fs8', 115)" onmouseover="showTip(event, 'fs8', 115)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">request</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span> <span class="i">e</span><span class="o">.</span><span class="i">RequestUri</span>)
<span class="l">3: </span>
<span class="l">4: </span><span onmouseout="hideTip(event, 'fs3', 116)" onmouseover="showTip(event, 'fs3', 116)" class="i">data</span><span class="o">.</span><span class="i">``Science and Technology``</span><span class="o">.</span><span class="i">Chemistry</span><span class="o">.</span>
<span class="l">5: </span>     <span class="i">``Chemical Elements``</span><span class="o">.</span><span class="i">Individuals</span><span class="o">.</span><span class="i">Hydrogen</span><span class="o">.</span><span class="i">``Atomic mass``</span><span class="o">.</span><span class="i">Mass</span></pre>
<h2>Related articles</h2>

<ul>
<li><a href="../fsharpdata.html">F# Data: Type Providers</a> - gives more information about other
type providers in the <code>FSharp.Data</code> package.</li>
<li><a href="http://www.tryfsharp.org/Learn/data-science">Try F#: Data Science</a> - The Data Science
tutorial on Try F# uses the Freebase type provider in numerous examples.</li>
<li><a href="http://blogs.msdn.com/b/fsharpteam/archive/2012/09/21/the-f-3-0-freebase-type-provider-sample-integrating-internet-scale-data-sources-into-a-strongly-typed-language.aspx">Visual F# Team Blog: Integrating Internet-Scale Data Sources into a Strongly Typed Language</a> - A series of 4 blog posts introducing the Freebase type provider</li>
<li><a href="http://skillsmatter.com/podcast/scala/an-informal-deep-dive-with-don-syme-the-freebase-type-provider">Demo by Don Syme</a> - An Informal Deep Dive With Don Syme: The Freebase Type Provider</li>
</ul>

          <div class="tip" id="fs1">namespace FSharp</div>
<div class="tip" id="fs2">namespace FSharp.Data</div>
<div class="tip" id="fs3">val data : obj<br /><br />Full name: Freebase.data</div>
<div class="tip" id="fs4">val elements : seq&lt;obj&gt;<br /><br />Full name: Freebase.elements</div>
<div class="tip" id="fs5">val all : obj list<br /><br />Full name: Freebase.all</div>
<div class="tip" id="fs6">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs7">val toList : source:seq&lt;&#39;T&gt; -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toList</div>
<div class="tip" id="fs8">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs9">val length : source:seq&lt;&#39;T&gt; -&gt; int<br /><br />Full name: Microsoft.FSharp.Collections.Seq.length</div>
<div class="tip" id="fs10">val hydrogen : obj<br /><br />Full name: Freebase.hydrogen</div>
<div class="tip" id="fs11">val firstnames : string []<br /><br />Full name: Freebase.firstnames</div>
<div class="tip" id="fs12">val truncate : count:int -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.truncate</div>
<div class="tip" id="fs13">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs14">val celeb : obj</div>
<div class="tip" id="fs15">module Array<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs16">val ofSeq : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.ofSeq</div>
<div class="tip" id="fs17">val surnames : string []<br /><br />Full name: Freebase.surnames</div>
<div class="tip" id="fs18">val name : obj</div>
<div class="tip" id="fs19">val randomElement : (string [] -&gt; string)<br /><br />Full name: Freebase.randomElement</div>
<div class="tip" id="fs20">val random : System.Random</div>
<div class="tip" id="fs21">namespace System</div>
<div class="tip" id="fs22">Multiple items<br />type Random =<br />&#160;&#160;new : unit -&gt; Random + 1 overload<br />&#160;&#160;member Next : unit -&gt; int + 2 overloads<br />&#160;&#160;member NextBytes : buffer:byte[] -&gt; unit<br />&#160;&#160;member NextDouble : unit -&gt; float<br /><br />Full name: System.Random<br /><br />--------------------<br />System.Random() : unit<br />System.Random(Seed: int) : unit</div>
<div class="tip" id="fs23">val arr : string []</div>
<div class="tip" id="fs24">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs25">System.Random.Next() : int<br />System.Random.Next(maxValue: int) : int<br />System.Random.Next(minValue: int, maxValue: int) : int</div>
<div class="tip" id="fs26">property System.Array.Length: int</div>
<div class="tip" id="fs27">val i : int32</div>
<div class="tip" id="fs28">val name : string</div>
<div class="tip" id="fs29">val astronomy : obj<br /><br />Full name: Freebase.astronomy</div>
<div class="tip" id="fs30">val query : Linq.QueryBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.query</div>
<div class="tip" id="fs31">val e : obj</div>
<div class="tip" id="fs32">custom operation: where (bool)<br /><br />Calls Linq.QueryBuilder.Where </div>
<div class="tip" id="fs33">custom operation: select (&#39;Result)<br /><br />Calls Linq.QueryBuilder.Select </div>
<div class="tip" id="fs34">custom operation: sortBy (&#39;Key)<br /><br />Calls Linq.QueryBuilder.SortBy </div>
<div class="tip" id="fs35">custom operation: take (int)<br /><br />Calls Linq.QueryBuilder.Take </div>
<div class="tip" id="fs36">module FreebaseOperators<br /><br />from FSharp.Data</div>
<div class="tip" id="fs37">val topBooksWithNameContaining : s:string -&gt; System.Linq.IQueryable&lt;&#39;a&gt;<br /><br />Full name: Freebase.topBooksWithNameContaining</div>
<div class="tip" id="fs38">val s : string</div>
<div class="tip" id="fs39">val book : obj</div>
<div class="tip" id="fs40">Multiple items<br />type LiteralAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; LiteralAttribute<br /><br />Full name: Microsoft.FSharp.Core.LiteralAttribute<br /><br />--------------------<br />new : unit -&gt; LiteralAttribute</div>
<div class="tip" id="fs41">val FreebaseApiKey : string<br /><br />Full name: Freebase.FreebaseApiKey</div>
<div class="tip" id="fs42">type FreebaseDataWithKey = obj<br /><br />Full name: Freebase.FreebaseDataWithKey</div>
<div class="tip" id="fs43">val dataWithKey : obj<br /><br />Full name: Freebase.dataWithKey</div>

        </div>
        <div class="span3">

          <ul class="nav nav-list" id="menu">
            <li class="nav-header">F# Data Library</li>
            <li><a href="http://fsharp.github.com/FSharp.Data/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="https://nuget.org/packages/FSharp.Data">Get Library via NuGet</a></li>
            <li><a href="https://github.com/fsharp/FSharp.Data">Source Code on GitHub</a></li>
            <li><a href="https://github.com/fsharp/FSharp.Data/blob/master/LICENSE.md">License (Apache 2.0)</a></li>
            <li><a href="https://github.com/fsharp/FSharp.Data/blob/master/RELEASE_NOTES.md">Release Notes</a></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/contributing.html">Contributing to F# Data</a></li>
            
            <li class="nav-header">Documentation</li>
            <li><a href="http://fsharp.github.com/FSharp.Data/fsharpdata.html">F# Data Library</a></li>
            <li class="divider"></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/library/JsonProvider.html">JSON Type Provider</a></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/library/XmlProvider.html">XML Type Provider</a></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/library/CsvProvider.html">CSV Type Provider</a></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/library/WorldBank.html">WorldBank Provider</a></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/library/Freebase.html">Freebase Provider</a></li>
            <li class="divider"></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/library/JsonValue.html">JSON Parser and Reader</a></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/library/CsvFile.html">CSV Parser and Reader</a></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/library/Http.html">HTTP Utilities</a></li>

            <li class="nav-header">Experimental</li>
            <li><a href="http://fsharp.github.com/FSharp.Data/experimental.html">F# Data Experimental</a></li>
            <li><a href="http://fsharp.github.com/FSharp.Data/experimental/ApiaryProvider.html">Apiary Type Provider</a></li>

          </ul>

        </div>
      </div>
    </div>
    <a href="https://github.com/fsharp/FSharp.Data"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
  </body>
  </html>